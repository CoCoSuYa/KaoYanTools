<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>AI聊天机器人</title>
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
   <h1>AI聊天机器人</h1>
   <div id="chat-box">
       <!-- 聊天记录将会在这里显示 -->
   </div>
   <script>
   function addMessageToChatBox(message, sender) {
       var chatBox = document.getElementById('chat-box');
       var messageElement = document.createElement('p');
       messageElement.textContent = sender + '：' + message;
       chatBox.appendChild(messageElement);
   }

   function sendMessageToServerAndReceiveResponse(event) {
       event.preventDefault();
       var form = event.target;
       var message = form.message.value;
       addMessageToChatBox(message, '你');

       $.ajax({
           url: '/ai',  // 你的服务器端路由
           type: 'POST',
           data: {
               message: message,
               csrf_token: '{{ form.csrf_token._value() }}'  // Flask-WTF表单的CSRF令牌
           },
           success: function(response) {
               addMessageToChatBox(response, '机器人');  // 假设服务器返回的响应是一个字符串
           }
       });
       form.message.value = '';  // 在发出请求后清空输入框
   }
   </script>

   <form method="POST" onsubmit="sendMessageToServerAndReceiveResponse(event)">
       {{ form.csrf_token }}
       {{ form.message.label }} <input id="message" type="text" name="message">
       {{ form.submit }}
   </form>
</body>
</html>